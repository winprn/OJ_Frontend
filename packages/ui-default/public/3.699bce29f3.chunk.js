(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{276:function(O,n,o){"use strict";o.r(n),o.d(n,"default",function(){return m});var c=o(1013),r=o.n(c),h=o(95),a=o.n(h),l=o(135),e=o(114),d=o(137);const f=d.a`<div style="position: fixed; left: 0px; bottom: -100px; width: 100%; \
background: rgb(255, 241, 184); z-index: 2147483647; color: rgb(97, 52, 0); \
text-align: center; font-size: 18px; font-family: Consolas, Menlo, Courier, monospace; \
padding: 8px 0px; box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 8px;" id="disconnect_notification" \
>${Object(e.a)("Disconnected from the server, trying to reconnect...")}</div>`,s=a()(f);s.appendTo("body");function u(){s.animate({bottom:0},100)}function E(){s.animate({bottom:-100},100)}class m{constructor(t,i=!0){this.url=t,this.isreconnect=!1,this.retryCount=0,this.init(),this.showNotification=i}onauth(){E(),this.retryCount=0,this.onopen&&this.onopen(this.sock)}init(){this.sock=new r.a(this.url),this.sock.onopen=()=>this.send(document.cookie),this.sock.onclose=({code:t,reason:i})=>{this.retryCount++,console.warn("Connection closed, ",t,i),t>=4e3&&(this.closed=!0),this.closed||(this.isreconnect=setTimeout(this.init.bind(this),3e3)),this.showNotification&&this.retryCount>3&&u(),this.onclose&&this.onclose(t,i)},this.sock.onmessage=t=>{const i=JSON.parse(t.data);i.event==="auth"?i.error==="PermissionError"||i.error==="PrivilegeError"?(this.showNotification&&l.a.info(Object(e.a)("Connect fail: Permission denied.")),this.closed=!0):this.onauth():this.onmessage&&this.onmessage(t)}}send(t){this.sock.send(t)}close(){this.closed=!0,this.sock.close()}}}}]);
